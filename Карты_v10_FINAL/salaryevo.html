<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞—Ä—Ç–∞ ‚Äî –°–∞–ª–∞—Ä—å–µ–≤–æ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Nunito',sans-serif;background:#f0f2f5}
.header{background:linear-gradient(135deg,#E65100 0%,#E65100cc 100%);color:#fff;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 8px rgba(0,0,0,.15);flex-wrap:wrap;gap:8px;position:relative;z-index:1000}
.header h1{font-size:20px;font-weight:700}
.header .badge{background:rgba(255,255,255,.2);padding:6px 14px;border-radius:20px;font-size:13px}
.header .back{color:#fff;text-decoration:none;font-size:14px;opacity:.8}.header .back:hover{opacity:1}
.container{display:flex;height:calc(100vh - 56px)}
#map{flex:1;z-index:1}
.sidebar{width:380px;background:#fff;overflow-y:auto;border-left:1px solid #ddd;z-index:2}
.analytics{padding:16px;border-bottom:2px solid #e8e8e8}
.analytics h3{font-size:13px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-bottom:12px}
.sg{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px}
.sc{background:#f8f9fa;border-radius:8px;padding:10px;text-align:center}
.sv{font-size:22px;font-weight:700;color:#E65100}.sl{font-size:11px;color:#888;margin-top:2px}
.rb{margin:8px 0}.rr{display:flex;align-items:center;margin:3px 0;font-size:12px}
.rl{width:52px;color:#666}.rbar{flex:1;height:16px;background:#eee;border-radius:8px;overflow:hidden;margin:0 6px}
.rf{height:100%;border-radius:8px}.rf.r3{background:linear-gradient(90deg,#2E7D32,#43A047)}.rf.r5{background:linear-gradient(90deg,#E65100,#FB8C00)}.rf.r10{background:linear-gradient(90deg,#C62828,#EF5350)}
.rn{width:28px;text-align:right;font-weight:600;color:#333}
.gb{margin:8px 0}.gbi{display:flex;height:22px;border-radius:11px;overflow:hidden}
.gm{background:#E65100;display:flex;align-items:center;justify-content:center;color:#fff;font-size:11px;font-weight:600}
.go{background:#E6510088;display:flex;align-items:center;justify-content:center;color:#fff;font-size:11px;font-weight:600}
.gl{display:flex;justify-content:space-between;font-size:11px;color:#888;margin-top:3px}
.tb{margin-top:8px}.tb h4{font-size:12px;color:#888;margin-bottom:4px}
.ti{font-size:12px;padding:3px 0;border-bottom:1px solid #f0f0f0}
.tc{display:inline-block;background:#E65100;color:#fff;border-radius:10px;width:22px;height:22px;text-align:center;line-height:22px;font-size:11px;font-weight:700;margin-right:5px}
.al{padding:0}.al h3{font-size:13px;color:#666;text-transform:uppercase;letter-spacing:1px;padding:12px 16px 8px}
.ai{padding:9px 16px;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .15s;display:flex;justify-content:space-between;align-items:center}
.ai:hover{background:#f0f6ff}.ai.active{background:#e3edfa;border-left:3px solid #E65100}
.an{font-size:13px;font-weight:600;color:#333}.at{font-size:11px;color:#888;margin-top:1px}
.ad{font-size:12px;font-weight:700;white-space:nowrap;margin-left:8px}
.dn{color:#2E7D32}.dm{color:#E65100}.df{color:#C62828}
.loading{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:24px 32px;border-radius:16px;box-shadow:0 4px 24px rgba(0,0,0,.25);z-index:10000;font-size:14px;text-align:center}
.prog{margin-top:8px;height:6px;background:#eee;border-radius:3px;width:300px}
.pbar{height:100%;background:#E65100;border-radius:3px;transition:width .3s}
.ls{margin-top:5px;font-size:12px;color:#888}
.eb{background:#ffebee;color:#c62828;padding:2px 6px;border-radius:3px;font-size:10px;margin-top:2px;display:inline-block}
@media(max-width:768px){.container{flex-direction:column-reverse}.sidebar{width:100%;height:40vh}#map{height:60vh}}
</style>
</head>
<body>
<div class="header">
  <div style="display:flex;align-items:center;gap:16px">
    <a href="index.html" class="back">‚Üê –í—Å–µ —Ñ–∏–ª–∏–∞–ª—ã</a>
    <h1>üå≥ –°–∞–ª–∞—Ä—å–µ–≤–æ</h1>
  </div>
  <div class="badge">üìç –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 12, —Å—Ç—Ä. 1</div>
</div>
<div class="container">
  <div id="map"></div>
  <div class="sidebar">
    <div class="analytics">
      <h3>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
      <div class="sg">
        <div class="sc"><div class="sv" id="a-total">139</div><div class="sl">–í—Å–µ–≥–æ –¥–µ—Ç–µ–π</div></div>
        <div class="sc"><div class="sv" id="a-median">‚Äî</div><div class="sl">–ú–µ–¥–∏–∞–Ω–∞ (–∫–º)</div></div>
        <div class="sc"><div class="sv" id="a-p80">‚Äî</div><div class="sl">80% –≤ —Ä–∞–¥–∏—É—Å–µ (–∫–º)</div></div>
        <div class="sc"><div class="sv" id="a-max">‚Äî</div><div class="sl">–ú–∞–∫—Å (–∫–º)</div></div>
      </div>
      <div class="rb">
        <div class="rr"><span class="rl">‚â§ 3 –∫–º</span><div class="rbar"><div class="rf r3" id="bar3" style="width:0%"></div></div><span class="rn" id="n3">‚Äî</span></div>
        <div class="rr"><span class="rl">‚â§ 5 –∫–º</span><div class="rbar"><div class="rf r5" id="bar5" style="width:0%"></div></div><span class="rn" id="n5">‚Äî</span></div>
        <div class="rr"><span class="rl">‚â§ 10 –∫–º</span><div class="rbar"><div class="rf r10" id="bar10" style="width:0%"></div></div><span class="rn" id="n10">‚Äî</span></div>
      </div>
      <div class="gb" id="geoBar" style="display:none">
        <div class="gbi">
          <div class="gm" id="gm" style="width:50%">–ú–æ—Å–∫–≤–∞ 0%</div>
          <div class="go" id="go" style="width:50%">–ú–û 0%</div>
        </div>
        <div class="gl"><span id="glm">–ú–æ—Å–∫–≤–∞: 0</span><span id="glo">–ú–û: 0</span></div>
      </div>
      <div class="tb" id="topAddrs"><h4>üèÜ –¢–æ–ø –∞–¥—Ä–µ—Å–∞</h4></div>
    </div>
    <div class="al">
      <h3>üìã –í—Å–µ –∞–¥—Ä–µ—Å–∞ (139)</h3>
      <div id="addrContainer"></div>
    </div>
  </div>
</div>
<div class="loading" id="loading">
  <div>üó∫ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã...</div>
  <div class="prog"><div class="pbar" id="pbar" style="width:0%"></div></div>
  <div class="ls" id="ls">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
</div>

<script>
const BASE_COORDS=[55.617684, 37.412009];
const BRANCH_KEY='salaryevo';
const ADDRESSES=[{"name": "???", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥.14, –∫.2, –∫–≤.756", "dist": 0.1}, {"name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î–û –æ—Ç —É—Ç–≤ –≤—Å—Ç—É–ø –≤–∑–Ω–æ—Å", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 16, –∫–æ—Ä–ø. 3, –∫–≤. 187", "dist": 0.1}, {"name": "–ë–µ–ª–æ–∫–æ–Ω—Å–∫–∏–π –ú–∏—Ö–∞–∏–ª", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è , –¥. 14/3 –∫–≤.1106", "dist": 0.1}, {"name": "–ì–∏–º–±–∞—Ç–æ–≤–∞ –•–∞–Ω–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è , –¥. 8, –∫. 2,–∫–≤. 57", "dist": 0.1}, {"name": "–î–°1 –º–∞—Ç–∫–∞–ø –ú–∞–∫–∞—Ä—Ü–æ–≤–∞ –ê–ª–∏—Å–∞", "address": "–≥. –≥. –ú–æ—Å–∫–≤–∞, —É–ª.–°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥.10, –∫.2, –∫–≤.127", "dist": 0.1}, {"name": "–ï–≤—Å—Ç—é—Ö–∏–Ω–∞ –ö—Ä–∏—Å—Ç–∏–Ω–∞", "address": "–≥.–ú–æ—Å–∫–≤–∞ ,–°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è —É–ª. –¥.14 –∫. 3 –∫–≤.711", "dist": 0.1}, {"name": "–ï–≥–æ—Ä–æ–≤ –ù–∏–∫–∏—Ç–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 16, –∫. 1, –∫–≤. 149", "dist": 0.1}, {"name": "–ó–∞—Ö–∞—Ä–∫–∏–Ω–∞ –ê–ª–µ–≤—Ç–∏–Ω–∞", "address": "–≥.–ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π ,—É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è ,–¥.16 ,–∫ .3 ,–∫–≤.761", "dist": 0.1}, {"name": "–ò—Å–∞–∫–æ–≤ —Ç—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 14, –∫–æ—Ä. 2, –∫–≤. 530", "dist": 0.1}, {"name": "–ö–∏–∫—Ç–µ–≤–∞ –ó–æ—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 10/1, –∫–≤. 20", "dist": 0.1}, {"name": "–ö–æ—à–º–∞–Ω–æ–≤ –ú–∏—Ö–∞–∏–ª", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π ,—É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è ,–¥.10 ,–∫ .2 ,–∫–≤. 68", "dist": 0.1}, {"name": "–õ–µ–æ–Ω—Ç—å–µ–≤–∞ –ó–∏–Ω–∞–∏–¥–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 9, –∫–≤. 306", "dist": 0.1}, {"name": "–õ–∏ –ü–µ–π–ª–∏–Ω—å", "address": "–ø–æ—Å.–ú–æ—Å–∫–æ–≤—Å–∫–∏–π,—É–ª.–°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è 16–∫1, –∫–≤.102", "dist": 0.1}, {"name": "–†–∞—Å—É–ª–æ–≤–∞ –°–æ—Ñ–∏—è", "address": "–ü–æ—Å–µ–ª–µ–Ω–∏–µ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –≥–æ—Ä. –ú–æ—Å–∫–≤–∞ —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 14, –∫–æ—Ä–ø. 3,1 –ø–æ–¥—ä–µ–∑–¥ –∫–≤. 135", "dist": 0.1}, {"name": "–†–æ–∂–∫–æ–≤–∞ –ö—Å–µ–Ω–∏—è", "address": "–≥.–ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥.16, –∫.4, –∫–≤. 35", "dist": 0.1}, {"name": "–°–µ–ª—è–≤–∫–æ –ì–µ—Ä–º–∞–Ω", "address": "–ø–æ—Å.–ú–æ—Å–∫–æ–≤—Å–∫–∏–π,—É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è  ,–¥. 9, –∫–≤. 521", "dist": 0.1}, {"name": "–°—Ç–µ–ø–∞–Ω–æ–≤–∞ –ê–ª–∏—Å–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–æ–µ, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è –¥.16, –∫.5, –∫–≤. 102", "dist": 0.1}, {"name": "–ß–∂–æ—É –ñ—É–π—Å—è–æ", "address": "–≥.–ú–æ—Å–∫–≤–∞, –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è —É–ª., –¥.8, –∫. 3", "dist": 0.1}, {"name": "–ú–∞–∫–∞—Ä–æ–≤–∞ –ê–ª–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –Æ–ª–∏–∞–Ω–∞ –°–µ–º—ë–Ω–æ–≤–∞, –¥.8, –∫. 2, –∫–≤. 483", "dist": 0.9}, {"name": "–ë–∏–ª–µ–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, –±-—Ä –ö–ª–µ–Ω–æ–≤—ã–π, –¥. 8, –∫. 2, –∫–≤. 161", "dist": 1.1}, {"name": "–•–∞—Ä–ª–∞–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è, –¥. 10, –∫. 1, –∫–≤. 703", "dist": 2.2}, {"name": "–ê—Ñ–∞–Ω–∞—Å—å–µ–≤ –ú–∞–∫—Å–∏–º", "address": "–≥.–ú–æ—Å–∫–≤–∞,—É–ª. –ú–∞–ª–æ–µ –ü–æ–Ω–∏–∑–æ–≤—å–µ –¥.4, –∫–≤. 513. —Å–µ–∫—Ü–∏—è 8", "dist": 2.5}, {"name": "–í–µ–ª–∏–∫–∞–Ω—Å–∫–∏–π –ï–≥–æ—Ä", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ú–∞–ª–æ–µ –ü–æ–Ω–∏–∑–æ–≤—å–µ, –¥. 8, –∫.2, –∫–≤. 62", "dist": 2.5}, {"name": "–ú–µ–ª—å–Ω–∏–∫ –ü–ª–∞—Ç–æ–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞ —É–ª. –°–æ–º–æ–≤–∞, –¥.30 ,–∫.1", "dist": 2.6}, {"name": "–ü—Ä–∏—Ü –ò–æ—Å–∏—Ñ", "address": "–≥.–ú–æ—Å–∫–≤–∞,–ø.–ì–∞–∑–æ–ø—Ä–æ–≤–æ–¥ , 5-—è —É–ª. –õ–µ—Å–Ω—ã–µ –ü–æ–ª—è–Ω—ã, –¥.15", "dist": 2.7}, {"name": "–°–∫—Ä—ã–ª–µ–≤–∞ –û–ª—å–≥–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –Ø–Ω–∫–æ–≤—Å–∫–æ–≥–æ, –¥.1, –∫.1, –∫–≤.300", "dist": 3.3}, {"name": "–ë–æ—Ä–∏—Å–æ–≤ –ê–ª–µ–∫—Å–µ–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∏—Ä–µ–Ω–µ–≤—ã–π —Ç—É–ø–∏–∫, –¥. 4–∞", "dist": 3.7}, {"name": "–ë–æ—Ä–∏—Å–æ–≤–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∏—Ä–µ–Ω–µ–≤—ã–π —Ç—É–ø–∏–∫, –¥. 4–∞", "dist": 3.7}, {"name": "–†–∂–µ–≤—Å–∫–∏–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–∫–∞–¥–µ–º–∏–∫–∞ –°–µ–º–µ–Ω–æ–≤–∞, –¥–æ–º–æ–≤–ª. 83, –∫. 1, —Å—Ç—Ä. 2", "dist": 3.8}, {"name": "–ë–µ—Ä–¥–Ω–∏–∫–æ–≤–∞ –ò–≤–∞–Ω–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ë–∞—á—É—Ä–∏–Ω—Å–∫–∞—è, –¥. 21,–∫–≤.130", "dist": 4.2}, {"name": "–ë–µ–∫—Å—É–ª—Ç–∞–Ω–æ–≤ –ê–º–∏—Ä", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –¥. –ö–∞—Ä—Ç–º–∞–∑–æ–≤–æ, —É–ª. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, –¥. 35", "dist": 4.3}, {"name": "–ì–ª–æ—Ç–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –ö–∞—Ä—Ç–º–∞–∑–æ–≤—Å–∫–∏–µ –ü—Ä—É–¥—ã, –¥. 2, –∫. 4, –∫–≤. 242", "dist": 4.3}, {"name": "–ì–Ω–∞—Ç—é–∫", "address": "–≥.–ú–æ—Å–∫–≤–∞,–¥.–ö–∞—Ä—Ç–º–∞–∑–æ–≤–æ, –ö–∏–µ–≤—Å–∫–∞—è —É–ª., –¥. 46", "dist": 4.3}, {"name": "–•–∞–º–∏–¥–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –¥–µ—Ä. –ö–∞—Ä—Ç–º–∞–∑–æ–≤–æ, —É–ª. –ö–∏–µ–≤—Å–∫–∞—è, –¥. 15", "dist": 4.3}, {"name": "–ê—Ä—Å–ª–∞–Ω –ú–µ–ª–∏—Å", "address": "–≥. –ú–æ—Å–∫–≤–∞, –∫–º –ö–∏–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 23-–π (–ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π), –¥. 7, –∫.2, –∫–≤. 162", "dist": 4.5}, {"name": "–ö–æ–≤—è–∑–∏–Ω–∞ –ú–∏—Ä—Ä–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª.  –ë–∏–∞–Ω–∫–∏, –¥. 8 –∫ .2 ,–∫–≤. 122", "dist": 4.5}, {"name": "–ö–æ—Ä–º–∞–Ω –†–æ–º–∞–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ö–º. –ö–∏–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 23-–π (–ø. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π), –¥. 7, –∫–≤. 214", "dist": 4.5}, {"name": "–ù–∏–∫–∏—Ç–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –ö–∏–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 23-–π –∫–º, –¥. 11–∫2, –∫–≤. 723", "dist": 4.5}, {"name": "–°–∏–¥–æ—Ä–µ–Ω–∫–æ –ù–∞—Ç–∞–ª—å—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ö–∏–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ 23-–π –∫–º. (–ø. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π), –¥. 5, –∫. 2, –∫–≤. 146", "dist": 4.5}, {"name": "–£–≥–ª–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, 23-–π –∫–º –ö–∏–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ (–ø. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π), –¥. 11, –∫. 2, –∫–≤. 1098", "dist": 4.5}, {"name": "–ö—É–¥–±—É–¥–∏–Ω–æ–≤ –ì–∞–º–∑–∞—Ç", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –ú–æ—Å—Ä–µ–Ω—Ç–≥–µ–Ω, –¥. –î—É–¥–∫–∏–Ω–æ, —Ç–µ—Ä. –°–ù–¢ –î—É–¥–∫–∏–Ω–æ, –≤–ª.96", "dist": 4.6}, {"name": "–û–≥–∞–Ω–µ—Å—è–Ω –≠—Ä–Ω–µ—Å—Ç", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å—Ä–µ–Ω—Ç–≥–µ–Ω, –∫–≤-–ª 10, –¥.17", "dist": 4.6}, {"name": "–ö–∞—Å–∏–º–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –§–∏–ª–∏–º–æ–Ω–∫–æ–≤—Å–∫–æ–µ, –¥. –ë—É—Ä—Ü–µ–≤–æ, —É–ª. –†–µ—á–Ω–∞—è, –¥. 22–ê", "dist": 5.4}, {"name": "–°–∞—Ñ—å—è–Ω–æ–≤ –ù–∏–∫–∏—Ç–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –§–∏–ª–∏–º–æ–Ω–æ–≤—Å–∫–æ–µ, –ö–í-–õ 110, –í–õ–î. 12, —Å—Ç—Ä. 1", "dist": 5.4}, {"name": "–•–µ–º–∞—à–µ–≤–∞ –õ–∞–ª–∏–Ω–∞", "address": "–≥.–ú–æ—Å–∫–≤–∞, —Ä-–Ω –§–∏–ª–∏–º–æ–Ω–∫–æ–≤—Å–∫–∏–π ,–≥. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π ,—É–ª. –†–∞–¥—É–∂–Ω–∞—è ,–¥.11,–∫–≤.197", "dist": 5.4}, {"name": "–Æ–¥–∏–Ω–∞ –Æ–ª–∏—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –§–∏–ª–∏–º–æ–Ω–∫–æ–≤—Å–∫–æ–µ , —É–ª. –ó–æ–ª–æ—Ç–æ—à–≤–µ–π–Ω–∞—è. 4, –∫–≤. 51", "dist": 5.4}, {"name": "–ì—É–∑–µ–≤", "address": "–ú–æ—Å–∫–≤–∞, —É–ª. 26 –ë–∞–∫–∏–Ω—Å–∫–∏—Ö –ö–æ–º–∏—Å—Å–∞—Ä–æ–≤, –¥–æ–º 7–∫6, –∫–≤. 96", "dist": 5.7}, {"name": "–ê–±—Ä–∞–º–æ–≤–∞ –û–ª—å–≥–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –õ—É–∫–∏–Ω—Å–∫–∞—è —É–ª. –¥.9 –∫–≤.12", "dist": 5.8}, {"name": "–î–û–ì —à–∫ –ö–æ–Ω—á–∞–∫–æ–≤ –ù–∏–∫–∏—Ç–∞", "address": "–ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, —É–ª. –°–µ—Ä–≤–∞–Ω—Ç–µ—Å–∞, –¥. 3, –∫. 2, –∫–≤. 144", "dist": 5.8}, {"name": "–ñ–∞–∫—Å—ã–ª—ã–∫", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –¥. –ù–∏–∫–æ–ª–æ-–•–æ–≤–∞–Ω—Å–∫–æ–µ, —É–ª. –ü–µ—Ç—Ä–∞ –í—è–∑–µ–º—Å–∫–æ–≥–æ, –¥. 6, –∫. 2, –∫–≤. 1", "dist": 5.8}, {"name": "–û–≥–∏–±–∞–ª–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –±-—Ä –í–µ–ª–∞—Å–∫–µ—Å–∞, –¥. 9, –∫. 1, –∫–≤. 161", "dist": 5.8}, {"name": "–ü–µ—Ç—Ä–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –∫–≤-–ª28, –¥. 2, –∫. 5, –∫–≤. 77", "dist": 5.8}, {"name": "–°–ê–î –î–°1 –ú–∞—Ä—Ç—ã–Ω–æ–≤ –õ—É–∫–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ , –ø—Ä-–∫—Ç –ú–∞–≥–µ–ª–ª–∞–Ω–∞, –¥. 4 , –∫–≤. 253", "dist": 5.8}, {"name": "–°–µ–¥–æ–≤–∞ –ú–∏—Ä–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –¥. –ó–∏–º–µ–Ω–∫–∏, –ö–ü –ê–Ω—Ç–æ–Ω–æ–≤–∫–∞, —É–ª, –°–æ–ª–Ω–µ—á–Ω–∞—è , –¥. 4", "dist": 5.8}, {"name": "–°—ã—á –ê—Ä—Å–µ–Ω–∏–π", "address": "–≥. –ú–æ—Å–∫–≤–∞ , –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –Ω–ø –î–µ—Ä–µ–≤–Ω—è –°–æ—Å–µ–Ω–∫–∏ –∂\\–∫ –î—É–±—Ä–æ–≤–∫–∞ ,—É–ª. –û—Ä–µ—Ö–æ–≤–∞—è, –¥. 6, –∫. 2, –∫–≤. 6", "dist": 5.8}, {"name": "–¢—É–º–∞–Ω—è–Ω –õ–∏–ª–∏—Ç", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ , —É–ª. –ë–æ–ª—å—à–æ–µ –ø–æ–Ω–∏–∑–æ–≤—å–µ, –¥. 10, –∫–≤. 17", "dist": 5.8}, {"name": "—à–∫ –ê–±–∏—à–∞–µ–≤ –î–∞–≤–∏–¥", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –¥. –ó–∏–º–µ–Ω–∫–∏, —É–ª. –°–æ–ª–Ω–µ—á–Ω–∞—è, –¥. 34", "dist": 5.8}, {"name": "–ë—É—Ä–∫–∞—Ü–∫–∏–π", "address": "–ú–æ—Å–∫–≤–∞, —É–ª. –ü–æ–∫—Ä—ã—à–∫–∏–Ω–∞, –¥–≤–ª–¥. 8, –∫–≤. 330", "dist": 6.0}, {"name": "–ü–µ—á–µ—Ä—Å–∫–∞—è –¢–∞—Ç—å—è–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å–µ–ª–æ–∫ –ë–ª–∞–≥–æ–¥–∞—Ç—å, —É–ª. –ì–µ–Ω–µ—Ä–∞–ª–∞ –¢—Ä–æ—à–µ–≤–∞, –¥.4", "dist": 6.1}, {"name": "–ú–æ—Ä–æ–∑–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ù–æ–≤–æ–æ—Ä–ª–æ–≤—Å–∫–∞—è, –¥. 14, –∫–≤. 187-190", "dist": 6.2}, {"name": "–°–∏–¥–æ—Ä–æ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ù–∏–∫–∏—Ç–∏–Ω–∞ , –¥. 8, –∫–≤. 160", "dist": 6.3}, {"name": "–ß–µ—Ä–Ω–µ–≤ –ú–∞–∫—Å–∏–º", "address": "–≥.–ú–æ—Å–∫–≤–∞, –ø—Ä-—Ç –ö—É–ø—Ä–∏–Ω–∞, –¥.38, –∫.1, –∫–≤. 51", "dist": 6.3}, {"name": "–ú–æ–ª—è–≤–∫–æ", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø—Ä-–¥ –†–∞–¥—É–∂–Ω—ã–π, –¥. 3, –∫–≤. 155", "dist": 6.5}, {"name": "–ù–∏–∫–æ–ª–∞–µ–≤–∞ –ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "address": "–ú–æ—Å–∫–≤–∞,—É–ª. –†–∞–¥—É–∂–Ω–∞—è, –¥. 13, –∫. 2, –∫–≤. 77", "dist": 6.5}, {"name": "–ß—É–º–∞—á–µ–Ω–∫–æ", "address": "–ú–æ—Å–∫–≤–∞, –≥. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –†–∞–¥—É–∂–Ω–∞—è, –¥. 13, –∫. 2, –∫–≤. 80", "dist": 6.5}, {"name": "–°–∞—Ç–∞–µ–≤–∞ –ú–∏—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–∞—Ä—É—à–∫–∏–Ω—Å–∫–æ–µ, –∫–≤-–ª 78, –¥. 86–∞, —Å—Ç—Ä.1", "dist": 6.7}, {"name": "–•–æ—Ö–ª–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–∞—Ä—É—à–∫–∏–Ω—Å–∫–æ–µ, –∫–≤-–ª 62, –≤–ª–¥. 42, —Å—Ç—Ä. 1", "dist": 6.7}, {"name": "–ê–Ω—Ç–æ–Ω–æ–≤–∞ –ò–ª–∞—Ä–∏—è", "address": "–ú–æ—Å–∫–≤–∞, –ø–æ—Å–µ–ª–µ–Ω–∏–µ –°–æ—Å–µ–Ω—Å–∫–æ–µ, –ø. –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, —É–ª. –õ–∞–∑—É—Ä–Ω–∞—è, –¥–æ–º 3, –∫–≤. 83", "dist": 6.9}, {"name": "–ë–µ—Ä–¥–Ω–∏–∫–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –ø–æ—Å. –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, —É–ª. –ë–∞—á—É—Ä–∏–Ω—Å–∫–∞—è, –¥. 21, –∫–≤. 130", "dist": 6.9}, {"name": "–í–ª–∞—Å–æ–≤", "address": "–ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –ø–æ—Å. –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, —É–ª. –§–∏—Ç–∞—Ä–µ–≤—Å–∫–∞—è, –¥. 15, –∫–≤. 224", "dist": 6.9}, {"name": "–ì–µ–ª—å—Ñ–∞–Ω–¥", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –ø. –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, —É–ª. –°–æ—Å–µ–Ω—Å–∫–∏–π —Å—Ç–∞–Ω, –¥. 11, –∫–≤. 326", "dist": 6.9}, {"name": "–ì—Ä–∏—à–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –º–∫—Ä. 3-–π, –¥. 4, –∫–≤. 80", "dist": 6.9}, {"name": "–î–∂–∞—Ñ–∞—Ä–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–ª–∏—Ä–µ–∑–∞–µ–≤–∏—á", "address": "–≥.–ú–æ—Å–∫–≤–∞, —Ä–∞–π–æ–Ω –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, –∫–≤–∞—Ä—Ç–∞–ª 41, –¥.171", "dist": 6.9}, {"name": "–ö–æ–≤–µ—à–Ω–∏–∫–æ–≤ –õ—É–∫–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –°–æ—Å–µ–Ω—Å–∫–æ–µ, –ø–æ—Å. –ö–æ–º–º—É–Ω–∞—Ä–∫–∞, —É–ª. –§–∏—Ç–∞—Ä—ë–≤—Å–∫–∞—è, –¥. 15, –∫. 1, –∫–≤. 120", "dist": 6.9}, {"name": "–ú–∞–ª–∞—Ñ–µ–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –ë–∏–∞–Ω–∫–∏, –¥. 1, –∫–≤. 200", "dist": 6.9}, {"name": "–û–≤—á–∏–Ω–Ω–∏–∫–æ–≤–∞", "address": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –≥.–æ. –î–æ–º–æ–¥–µ–¥–æ–≤–æ, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 17, –∫–æ–º–Ω–∞—Ç–∞ 1", "dist": 6.9}, {"name": "–û—á–∏—Ä–æ–≤ –°–∞—à–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –†–æ–¥–Ω–∏–∫–æ–≤–∞—è, –¥.30, –∫.3, –∫–≤.1124", "dist": 6.9}, {"name": "–¢–∏–ø–æ–≤–æ–π —à–∫–æ–ª–∞ –≤—Å—Ç—É–ø –≤–Ω–æ—Å", "address": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –≥. –î–æ–º–æ–¥–µ–¥–æ–≤–æ, –º–∫—Ä. –ó–∞–ø–∞–¥–Ω—ã–π, —É–ª. –õ—É–Ω–Ω–∞—è, –¥. 35, –∫–≤. 397", "dist": 6.9}, {"name": "–ß–µ–ø—É—Ä–Ω–∞—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, –≥. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, 3 –º–∫—Ä., –¥. 9, –∫–≤. 339", "dist": 6.9}, {"name": "–®–∏–¥–∏–π", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –õ–∞–ø—Ç–µ–≤–∞, –¥. 6, –∫–æ—Ä–ø. 1, –∫–≤. 145", "dist": 6.9}, {"name": "—É—á –ì—Ä–∏–Ω–µ–Ω–∫–æ –ê–ª–∏—Å–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –ú–æ—Å–∫–æ–≤—Å–∫–∏–π, —É–ª. –†–æ–¥–Ω–∏–∫–æ–≤–∞—è, –¥. 30, –∫. 1, –∫–≤. 1527", "dist": 6.9}, {"name": "–ê–≤–µ—Ä—å—è–Ω–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ù–∏–∫—É–ª–∏–Ω—Å–∫–∞—è, –¥. 15 –∫–æ—Ä–ø. 3, –∫–≤. 550", "dist": 7.4}, {"name": "–ö–æ—Ä—á–∞–≥–∏–Ω–∞", "address": "–≥.–ú–æ—Å–∫–≤–∞, –ö–∞–ª—É–∂—Å–∫–æ–µ —à., —É–ª.–Ø—Å–µ–Ω–µ–≤–∞—è, –¥.1, –∫–æ—Ä–ø.1, –∫–≤.136", "dist": 7.9}, {"name": "???", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–∫–∞–¥–µ–º–∏–∫–∞ –ê–Ω–æ—Ö–∏–Ω–∞, –¥.2, –∫–æ—Ä–ø. 3, –∫–≤. 180", "dist": 8.3}, {"name": "–ö—Ä—é—á–µ–Ω–∫–æ–≤ –°–µ—Ä–≥–µ–π", "address": "–≥.–ú–æ—Å–∫–≤–∞,–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø.,–¥.131,–∫–≤.429", "dist": 8.5}, {"name": "–ö—É–∑—å–º–∏–Ω–∞ –ö–∏—Ä–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø. –¥.139, –∫–≤.127", "dist": 8.5}, {"name": "–ú–∞–≥–æ–º–∞–µ–≤ –î–∞–Ω–∏—è–ª", "address": "–≥. –ú–æ—Å–∫–≤–∞, –õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç –¥. 111,  –∫–æ—Ä–ø. 1, –∫–≤. 17", "dist": 8.5}, {"name": "–°–ø–∏—Ä–∏–¥–æ–Ω–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è", "address": "–≥.–ú–æ—Å–∫–≤–∞,–õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø.,–¥.139,–∫–≤.14", "dist": 8.5}, {"name": "–°—É—Ö–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø—Ä-–∫—Ç –õ–µ–Ω–∏–Ω—Å–∫–∏–π, –¥. 21, –∫–≤. 43", "dist": 8.5}, {"name": "–ë—ã–∫–æ–≤ –ê–Ω—Ç–æ–Ω", "address": "–≥.–ú–æ—Å–∫–≤–∞,–ø—Ä-—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ ,–¥.109,–∫–≤.38", "dist": 8.6}, {"name": "–ò–∑—ä—è–Ω–æ–≤", "address": "–≥–æ—Ä. –ú–æ—Å–∫–≤–∞, –ø—Ä-–∫—Ç –ü—Ä–æ—Å–ø–µ–∫—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ –¥–æ–º 99, –∫–æ—Ä–ø. 3, –∫–≤. 16", "dist": 8.6}, {"name": "–ö—É–ª–∞–∫–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–æ—Å–ø–µ–∫—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ, –¥. 94, –∫. 1, –∫–≤. 10", "dist": 8.6}, {"name": "–ù–æ—Ä–∫–∏–Ω –î–µ–º–∏–¥", "address": "–ì. –ú–û–°–ö–í–ê –ü–û–°. –í–ù–£–ö–û–í–°–ö–û–ï –ë-–† –ê–ù–î–†–ï–Ø –¢–ê–†–ö–û–í–°–ö–û–ì–û, –î–û–ú 5, –ö–í–ê–†–¢–ò–†–ê 496", "dist": 8.6}, {"name": "–†—è–±–∏–Ω–∏–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–æ—Å. –í–Ω—É–∫–æ–≤—Å–∫–æ–µ, —É–ª. –ë–æ—Ä–∏—Å–∞ –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫–∞, –¥. 33–∫1, –∫–≤. 93", "dist": 8.6}, {"name": "–¢–∏—Ç–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø—Ä-–∫—Ç –í–µ—Ä–Ω–∞–¥—Å–∫–æ–≥–æ, –¥. 15, –∫–≤. 112", "dist": 8.6}, {"name": "–ú–æ—Ä–æ–∑–æ–≤ –ò–≤–∞–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–¥–º–∏—Ä–∞–ª–∞ –õ–∞–∑–∞—Ä–µ–≤–∞, –¥. 63, –∫. 3, –∫–≤. 52", "dist": 9.6}, {"name": "–°–æ—Å—Ñ–µ–Ω–æ–≤ –î–∞–Ω–∏–∏–ª", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–æ–±–∞—á–µ–≤—Å–∫–æ–≥–æ, –¥. 2, –∫–≤. 63", "dist": 9.9}, {"name": "–Ø–∫–æ–±–µ–Ω–∫–æ", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ú–∞—Ç–≤–µ–µ–≤—Å–∫–∞—è, –¥. 26, –∫–≤. 73", "dist": 10.5}, {"name": "–†–æ–Ω–∞–º–∏ –î–∏–∞–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π, –¥. 7, –∫. 2, –∫–≤. 63", "dist": 10.9}, {"name": "–•–∞–º–∏—Ä–∑–∞–µ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, –º–∫—Ä. –°–µ–≤–µ—Ä–Ω–æ–µ –ß–µ—Ä—Ç–∞–Ω–æ–≤–æ, –¥.1, –∫.1, –∫–≤. 229", "dist": 11.0}, {"name": "–ó–æ—Ä–∏–Ω–∞", "address": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –û–¥–∏–Ω—Ü–æ–≤—Å–∫–∏–π —Ä-–Ω, —Ä–ø –ó–∞—Ä–µ—á—å–µ, —É–ª. –ú–µ–¥–æ–≤–∞—è, –¥. 4, –∫–≤. 306", "dist": 11.2}, {"name": "–ú—É—à—Ç–µ–Ω–∫–æ", "address": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –û–¥–∏–Ω—Ü–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω, —Ä.–ø. –ó–∞—Ä–µ—á—å–µ, —É–ª. –ú–µ–¥–æ–≤–∞—è, –¥. 4, –∫–≤. 108", "dist": 11.2}, {"name": "–ú–∏–ª–æ—Å–µ—Ä–¥–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –§–æ—Ç–∏–µ–≤–æ–π, –¥. 7, –∫–≤. 144", "dist": 11.5}, {"name": "–ê–≥–∞—Ñ–æ–Ω–∫–∏–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–º–æ—Ä—ã –ú–∞—à–µ–ª–∞, –¥. 8, –∫. 3, –∫–≤. 108", "dist": 11.6}, {"name": "–®–≤—ã–¥–∫–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è", "address": "–≥.–ú–æ—Å–∫–≤–∞,–±-—Ä –î–º–∏—Ç—Ä–∏—è –î–æ–Ω—Å–∫–æ–≥–æ, –¥. 11, –∫–≤. 229", "dist": 11.7}, {"name": "–ë–∞–∫–∞–µ–≤–∞", "address": "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª., —Ä-–Ω–∞ –ù–∞—Ä–æ-–§–æ–º–∏–Ω—Å–∫–∏–π, –≥. –ê–ø—Ä–µ–ª–µ–≤–∫–∞, —É–ª. –û—Å—Ç—Ä–æ–≤—Å–∫–æ–≥–æ, –¥. 38, –∫–≤. 38", "dist": 12.4}, {"name": "–°—É–≥—è–Ω –ê—Ä–µ–≥ –ì–∞—Ä–∏–∫–æ–≤–∏—á", "address": "–≥. –ú–æ—Å–∫–≤–∞ , –≤–Ω. —Ç–µ—Ä. –≥. –ø–æ—Å. –ü–µ—Ä–≤–æ–º–∞–π—Å–∫–æ–µ ,–¥. –§–æ–º–∏–Ω—Å–∫–æ–µ , —É–ª. 2-—è –§–æ–º–∏–Ω—Å–∫–∞—è , –¥. 6–ì", "dist": 12.4}, {"name": "–ê–ª–µ—à–∏–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, –°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä, –¥. 27, –∫–≤. 3", "dist": 12.6}, {"name": "–ù–µ–ø–æ—á–∞—Ç—ã—Ö", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∏–≤–∞—à—Å–∫–∞—è, –¥. 4, –∫–≤. 54", "dist": 12.7}, {"name": "–ë–∞–π–∫–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –ö—Ä–∞—Å–Ω–æ–ø–∞—Ö–æ—Ä—Å–∫–æ–µ, —É–ª. –ë–∏–ª–∏–±–∏–Ω–∞, –¥. 31, –∫. 1", "dist": 13.4}, {"name": "–ö—Ä—É—Ç–æ–≤ –î–µ–º–∏–¥", "address": "–≥.–ú–æ—Å–∫–≤–∞ , —É–ª.–ù–∞–≥–æ—Ä–Ω–∞—è,–¥. 39,–∫. 4 ,–∫–≤. 45", "dist": 13.7}, {"name": "–ê–∫–æ–ø—è–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –•–µ—Ä—Å–æ–Ω—Å–∫–∞—è, –¥. 43–∫5, –∫–≤. 340", "dist": 13.9}, {"name": "–ì—Ä–∏–Ω–µ–Ω–∫–æ –õ–µ–æ–Ω–∏–¥", "address": "–≥. –ú–æ—Å–∫–≤–∞, –•–µ—Ä—Å–æ–Ω—Å–∫–∞—è —É–ª., –¥.31, –∫–≤.25", "dist": 13.9}, {"name": "???", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê–∫–∞–¥–µ–º–∏–∫–∞ –ü–∞–≤–ª–æ–≤–∞ –¥. 56, –∫–≤. 152", "dist": 14.3}, {"name": "–®–æ—à–∞—Ä –°–∞–º–∏ –≠–º–∏–ª—å", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –£—Å–∞—á–µ–≤–∞, –¥. 19 –ê, –∫. 2, –∫–≤. 95", "dist": 14.7}, {"name": "–ñ–∞–∫–æ–≤–∞ –ö—Ä–∏—Å—Ç–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø. –ö–æ–∫–æ—à–∫–∏–Ω–æ, –¥–ø. –ö–æ–∫–æ—à–∫–∏–Ω–æ —É–ª. –ò—é–Ω—å—Å–∫–∞—è, –¥. 29", "dist": 15.4}, {"name": "–î–∞–≤–∏–¥—è–Ω –õ–µ–≤–æ–Ω", "address": "–≥.–ú–æ—Å–∫–≤–∞ —É–ª. –®–∞–±–æ–ª–æ–≤–∫–∞ –¥.23., –∫–≤ 409", "dist": 16.4}, {"name": "–ö—Ä—É–≥–ª–æ–≤–∞ –ú–∞—Ä–∏—è", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ö–∏–µ–≤—Å–∫–∞—è, –¥. 48", "dist": 16.9}, {"name": "???", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –©—É—Å–µ–≤–∞, –¥. 2, –∫–æ—Ä–ø. 1. –∫–≤. 129", "dist": 17.6}, {"name": "–°–µ—Ä–µ–±—Ä–µ–Ω–Ω–∏–∫–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ö–æ—Å–º–æ–¥–∞–º–∏–∞–Ω—Å–∫–∞—è –Ω–∞–±., –¥. 4/22, –∫. –ê, –∫–≤. 91", "dist": 19.6}, {"name": "–ö–æ–≤–∞–ª—å—á—É–∫", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–¥–æ–≤–∞—è-–°–∞–º–æ—Ç–µ—á–Ω–∞—è, –¥. 7, —Å—Ç—Ä. 2 –∫–≤. 76", "dist": 20.9}, {"name": "–ú–µ—Ö—Ç–∏–µ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –í–æ–ª–æ—á–∞–µ–≤—Å–∫–∞—è, –¥. 18, –æ–±—â", "dist": 21.3}, {"name": "–®–µ–≤—Ü–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü–µ—Ä–µ—Ä–≤–∞, –¥. 52, –∫–≤. 234", "dist": 21.3}, {"name": "–ê–ª–∏–µ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ø–µ—Ä. –õ—è–ª–∏–Ω, –¥. 9, —Å. 3, –∫–≤. 22", "dist": 21.5}, {"name": "–ó–∞—Ä—É–±—å—è–Ω –ò–≤–∞–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, –õ—è–ª–∏–Ω –ø–µ—Ä–µ—É–ª–æ–∫ , –¥. 22, –∫–≤. 23", "dist": 21.5}, {"name": "–ü–æ–ø–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ—å–≤–∞ –Ø—à–∏–Ω–∞, –¥. 7, –∫–≤. 186", "dist": 21.6}, {"name": "–ö–æ—Ö–∞–Ω", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –î—É—Ä–æ–≤–∞, –¥. 3/13, –∫–≤. 67", "dist": 22.0}, {"name": "–°–º–∏—Ä–Ω–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è, –¥. 70, –∫. 1, –∫–≤. 207", "dist": 22.1}, {"name": "–ú–µ–ª–µ–Ω—Ç—å–µ–≤–∞ –ö—Ä–∏—Å—Ç–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –§—Ä–∏–¥—Ä–∏—Ö–∞ –≠–Ω–≥–µ–ª—å—Å–∞, –¥. 31/35, –∫–≤. 77", "dist": 22.2}, {"name": "–¢—Ä–∏—à–∏–Ω –î–µ–º–∏–¥", "address": "–≥. –ú–æ—Å–∫–≤–∞, –Æ–Ω–Ω–∞—Ç–æ–≤ —É–ª. –¥.17, –∫. 4, –∫–≤.87", "dist": 22.4}, {"name": "???", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –Æ–Ω—ã—Ö –õ–µ–Ω–∏–Ω—Ü–µ–≤, –¥. 123, –∫–≤. 51", "dist": 23.3}, {"name": "–ë—Ä–æ–Ω—å –ù–∞–∏–º–æ–≤–∞ –ú–∞—Ä—å—è–º", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, –¥. 80/2, –∫. 2, –∫–≤. 64", "dist": 23.4}, {"name": "–ì–∞–π–Ω—É—Ç–¥–∏–Ω–æ–≤–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, –¥. 80/2, –∫. 2, –∫–≤. 64", "dist": 23.4}, {"name": "–•–æ–∂–∏–∞—Ö–º–µ—Ç–æ–≤–∞ –õ–∏—è", "address": "–≥. –ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫, –±—É–ª—å–≤–∞—Ä –ö–æ—Å–º–æ–Ω–∞–≤—Ç–æ–≤, –¥. 5. –∫–≤. 8", "dist": 23.9}, {"name": "–¢–∏–º–æ–Ω–∏–Ω–∞ –ê—Ä–∏–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞, –ú–∞–ª—ã–π –ö–æ–ø—Ç–µ–≤—Å–∫–∏–π –ø—Ä–æ–µ–∑–¥, –¥. 6, –∫. 2, –∫–≤. 89", "dist": 24.1}, {"name": "–ò–≤–∞—Ü–µ–≤–∏—á –î–∏–∞–Ω–∞", "address": "–≥. –ú–æ—Å–∫–≤–∞. –ü—Ä–æ—Å–ø. –ë—É–¥–µ–Ω–Ω–æ–≥–æ, –¥. 29/1, –∫–≤. 12", "dist": 24.2}, {"name": "–†–æ–º–∞–Ω–æ–≤ –õ–µ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –î–æ–º–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –¥. 14, –∫–≤. 216", "dist": 26.2}, {"name": "–ü–ª–µ—à–∞–∫–æ–≤", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –î–µ–≥—É–Ω–∏–Ω—Å–∫–∞—è, –¥. 2, –∫. 2, –∂–∏–ª.–ø–æ–º. 37", "dist": 28.2}, {"name": "–î—Ä–∞–≥—É–Ω–æ–≤ –ú–∞—Ä–∫", "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª –ë–∞–π–∫–∞–ª—å—Å–∫–∞—è –¥. 26/10,–∫–≤.16_", "dist": 29.0}];


const DADATA_KEY='d065d9bbc5abd65bbe173c43fb3f71802e115614';
const delay = ms => new Promise(r => setTimeout(r, ms));

function cleanAddress(addr) {
  let c = addr.replace(/\u00a0/g, ' ');
  c = c.replace(/,(?=\S)/g, ', ');
  c = c.replace(/\.(?=[–∞-—è–ê-–Ø])/g, '. ');
  
  // Remove apartment
  c = c.replace(/(?<=[,\s.])\s*(?:–∫–≤(?!–∞—Ä—Ç–∞–ª)(?:–∞—Ä—Ç–∏—Ä–∞)?|–∂–∏–ª\.?\s*–ø–æ–º)\.?\s*[\.\s]*[\d\/_\-–∞-—è–ê-–Øa-zA-Z]*/gi, '');
  c = c.replace(/,?\s*\d+\s*–ø–æ–¥—ä–µ–∑–¥/gi, '');
  c = c.replace(/,?\s*—Å–µ–∫—Ü–∏—è\s*\d+/gi, '');
  
  // Remove –ñ–ö, –ö–ü, –ù–ü
  c = c.replace(/,?\s*(?:–ñ–ö|–∂\\?–∫|–ö–ü|–ù–ü|–Ω–ø)\s+[–∞-—è–ê-–Ø—ë–Å"¬´¬ª\-\s]+,/gi, ',');
  c = c.replace(/,?\s*(?:–ñ–ö|–∂\\?–∫|–ö–ü)\s+[–∞-—è–ê-–Ø—ë–Å"¬´¬ª\-]+\s*,?/gi, ',');
  
  // Remove settlements
  c = c.replace(/,?\s*(?:–ü–æ—Å–µ–ª–µ–Ω–∏–µ|–ø–æ—Å—ë–ª–æ–∫\s+–≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ\s+—Ç–∏–ø–∞|–ø–æ—Å(?:—ë–ª–æ–∫|–µ–ª–æ–∫)?\.?\s*|–ø\.)\s*[–∞-—è–ê-–Ø—ë–Å]+\s*,?/gi, ',');
  
  // Remove village names
  c = c.replace(/,?\s*–Ω–ø\s+–î–µ—Ä–µ–≤–Ω—è\s+[–∞-—è–ê-–Ø—ë–Å]+\s*,?/gi, ',');
  c = c.replace(/,?\s*(?:–¥\.|–¥–µ—Ä\.)\s*[–ê-–Ø–Å][–∞-—è—ë–ê-–Ø–Å\-]+\s*,/g, ',');
  
  // Remove districts
  c = c.replace(/,?\s*[–∞-—è–ê-–Ø—ë–Å]+\s+—Ä-–Ω\s*,?/gi, ',');
  c = c.replace(/,?\s*—Ä-–Ω[–∞—É–µ]?\s+[–∞-—è–ê-–Ø—ë–Å\-]+\s*,?/gi, ',');
  c = c.replace(/,?\s*(?:–°–µ–≤–µ—Ä–æ-|–Æ–≥–æ-)?(?:–í–æ—Å—Ç–æ—á–Ω—ã–π|–ó–∞–ø–∞–¥–Ω—ã–π|–°–µ–≤–µ—Ä–Ω—ã–π|–Æ–∂–Ω—ã–π|–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π)\s*(?:–ê–û|–∞–¥–º\.?\s*–æ–∫—Ä—É–≥)\s*,?/gi, ',');
  c = c.replace(/,?\s*(?:–æ–∫—Ä—É–≥\s+)?(?:–ó–ê–û|–í–ê–û|–°–ê–û|–Æ–ê–û|–°–í–ê–û|–°–ó–ê–û|–Æ–ó–ê–û|–Æ–í–ê–û)\b\s*,?/gi, ',');
  c = c.replace(/,?\s*–≤–Ω\.\s*—Ç–µ—Ä\.\s*–≥\.\s*/gi, ',');
  
  // Remove parentheses
  c = c.replace(/\s*\([^)]+\)\s*/g, ' ');
  
  // Fix abbreviations
  c = c.replace(/\b–≥–æ—Ä\.\s*/gi, '–≥. ');
  c = c.replace(/\b–¥–æ–º–æ–≤–ª\.\s*/gi, '–¥. ');
  c = c.replace(/\b–¥–≤–ª–¥\.\s*/gi, '–¥. ');
  c = c.replace(/\b–≤–ª–¥\.\s*/gi, '–¥. ');
  c = c.replace(/\b–ö–º\.\s*/gi, '');
  
  // "—É–ª. –õ–∞–∑–æ—Ä–µ–≤—ã–π –ø—Ä." ‚Üí "–õ–∞–∑–æ—Ä–µ–≤—ã–π –ø—Ä–æ–µ–∑–¥"
  c = c.replace(/\b—É–ª\.\s*([–ê-–Ø–Å][–∞-—è—ë–ê-–Ø–Å\-\d]+)\s+–ø—Ä\./g, '$1 –ø—Ä–æ–µ–∑–¥');
  
  // "—É–ª. –†—É–±–ª–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ" ‚Üí "–†—É–±–ª–µ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ"
  c = c.replace(/\b—É–ª\.\s*([–ê-–Ø–Å][–∞-—è—ë–ê-–Ø–Å\-]+\s+(?:—à–æ—Å—Å–µ|—à\.))/gi, '$1');
  
  // Remove highway km markers but keep highway name
  c = c.replace(/(–ö–∏–µ–≤—Å–∫–æ–µ|–ú–ö–ê–î|–ö–∞–ª—É–∂—Å–∫–æ–µ|–í–∞—Ä—à–∞–≤—Å–∫–æ–µ|–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–µ)\s+(?:—à–æ—Å—Å–µ|—à\.)\s*[\d\-]+(?:-–π)?\s*(?:–∫–º)?/gi, '$1 —à–æ—Å—Å–µ');
  
  // "–ö–∞–ª—É–∂—Å–∫–æ–µ —à., —É–ª.–Ø—Å–µ–Ω–µ–≤–∞—è" - remove highway, keep street
  if (/(?:—à\.|—à–æ—Å—Å–µ)[,\s]+(?:—É–ª\.|—É–ª–∏—Ü–∞)/i.test(c)) {
    c = c.replace(/^.*?(?:—à\.|—à–æ—Å—Å–µ)[,\s]+/i, '');
  }
  
  // "–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª." - remove, keep rest
  c = c.replace(/–ú–æ—Å–∫–æ–≤—Å–∫–∞—è\s+–æ–±–ª\.?,?\s*/gi, '');
  
  // Clean
  c = c.replace(/,\s*,/g, ',').replace(/\s+/g, ' ').replace(/^[,\s]+|[,.\s]+$/g, '').trim();
  return c;
}

function ensureCity(cleaned) {
  if (/(?:–º–æ—Å–∫–≤|—Ö–∏–º–∫–∏|–º—ã—Ç–∏—â–∏|–¥–æ–ª–≥–æ–ø—Ä—É–¥–Ω|–±–∞–ª–∞—à–∏—Ö–∞|—Ä–µ—É—Ç–æ–≤|–ø—É—à–∫–∏–Ω–æ|—â–µ–ª–∫–æ–≤|–∫—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫|–æ–¥–∏–Ω—Ü–æ–≤|–∑–∞—Ä–µ—á—å–µ|–∫–æ–º–º—É–Ω–∞—Ä–∫–∞|–ø–∞–≤—à–∏–Ω|–∑–µ–ª–µ–Ω–æ–≥—Ä–∞–¥|—Ç—Ä–æ–∏—Ü–∫|—Å–µ—Ä–≥–∏–µ–≤|–∞–ø—Ä–µ–ª–µ–≤–∫–∞|–≤–∏–¥–Ω–æ–µ|–ª–æ–±–Ω—è)/i.test(cleaned)) {
    return cleaned;
  }
  return '–ú–æ—Å–∫–≤–∞, ' + cleaned;
}

async function callDadata(query) {
  try {
    const r = await fetch('https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'Accept': 'application/json', 'Authorization': 'Token ' + DADATA_KEY },
      body: JSON.stringify({ query: query, count: 1 })
    });
    if (!r.ok) return null;
    const d = await r.json();
    if (d.suggestions && d.suggestions.length > 0) {
      const s = d.suggestions[0].data;
      if (s.geo_lat && s.geo_lon) {
        return { coords: [parseFloat(s.geo_lat), parseFloat(s.geo_lon)], qc: s.qc_geo || 0, resolved: d.suggestions[0].value };
      }
    }
  } catch(e) { console.error('DaData error:', query, e); }
  return null;
}

async function geocode(address) {
  const cleaned = cleanAddress(address);
  let result = await callDadata(cleaned);
  if (result) return result;

  const withCity = ensureCity(cleaned);
  if (withCity !== cleaned) {
    result = await callDadata(withCity);
    if (result) return result;
  }

  // Strip all abbreviations
  let simple = cleaned.replace(/\b(?:—É–ª|–¥|–∫|—Å—Ç—Ä|–∫–æ—Ä–ø|–ø—Ä-–¥|—à|–∞–ª|–ø—Ä|–º–∫—Ä|–æ–±–ª|—Ç–µ—Ä|–º–∫—Ä–Ω|–±-—Ä|–ø–µ—Ä|–ø—Ä–æ—Å–ø|–ø—Ä-–∫—Ç)\.\s*/gi, ' ');
  simple = simple.replace(/\b(?:—É–ª–∏—Ü–∞|–¥–æ–º|–∫–æ—Ä–ø—É—Å|—Å—Ç—Ä–æ–µ–Ω–∏–µ|–ø—Ä–æ–µ–∑–¥|—à–æ—Å—Å–µ|–∞–ª–ª–µ—è|–ø—Ä–æ—Å–ø–µ–∫—Ç|–±—É–ª—å–≤–∞—Ä|—Ç—É–ø–∏–∫|–ø–µ—Ä–µ—É–ª–æ–∫)\b/gi, ' ');
  simple = simple.replace(/\s+/g, ' ').replace(/^[,\s]+|[,.\s]+$/g, '').trim();
  simple = ensureCity(simple);
  if (simple !== cleaned && simple !== withCity) {
    result = await callDadata(simple);
    if (result) return result;
  }

  return null;
}

function getCacheKey() { return 'geo_v10_' + BRANCH_KEY; }
function loadCache() { try { const c = localStorage.getItem(getCacheKey()); return c ? JSON.parse(c) : {}; } catch(e) { return {}; } }
function saveCache(cache) { try { localStorage.setItem(getCacheKey(), JSON.stringify(cache)); } catch(e) {} }

function haversine(c1,c2) {
  const R=6371, toR=Math.PI/180;
  const dLat=(c2[0]-c1[0])*toR, dLon=(c2[1]-c1[1])*toR;
  const a=Math.sin(dLat/2)**2 + Math.cos(c1[0]*toR)*Math.cos(c2[0]*toR)*Math.sin(dLon/2)**2;
  return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
}
function distClass(d) { return d<=3?'dn':d<=15?'dm':'df'; }
function distColor(d) { return d<=2?'#2E7D32':d<=5?'#43A047':d<=10?'#FB8C00':d<=15?'#E65100':'#C62828'; }
function createIcon(color) {
  return L.divIcon({ className:'', html:'<div style="width:14px;height:14px;background:'+color+';border:2px solid #fff;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.3)"></div>', iconSize:[14,14],iconAnchor:[7,7] });
}


function updateAnalytics(dists) {
  const n=dists.length; if(!n) return;
  dists.sort((a,b)=>a-b);
  const med=n%2?dists[Math.floor(n/2)]:(dists[n/2-1]+dists[n/2])/2;
  const p80=dists[Math.min(Math.floor(n*.8),n-1)];
  const mx=dists[n-1];
  const le3=dists.filter(d=>d<=3).length,le5=dists.filter(d=>d<=5).length,le10=dists.filter(d=>d<=10).length;
  document.getElementById('a-median').textContent=med.toFixed(1);
  document.getElementById('a-p80').textContent=p80.toFixed(1);
  document.getElementById('a-max').textContent=mx.toFixed(1);
  document.getElementById('n3').textContent=le3;document.getElementById('n5').textContent=le5;document.getElementById('n10').textContent=le10;
  document.getElementById('bar3').style.width=Math.round(le3/n*100)+'%';
  document.getElementById('bar5').style.width=Math.round(le5/n*100)+'%';
  document.getElementById('bar10').style.width=Math.round(le10/n*100)+'%';
}

(async function() {
  const ls=document.getElementById('ls'),pb=document.getElementById('pbar'),ld=document.getElementById('loading');
  const container=document.getElementById('addrContainer');
  const cache=loadCache();

  if (Object.keys(cache).length>0) ls.textContent='–ö–µ—à: '+Object.keys(cache).length+' –∞–¥—Ä–µ—Å–æ–≤...';

  const map=L.map('map').setView(BASE_COORDS,13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OpenStreetMap',maxZoom:19}).addTo(map);

  L.marker(BASE_COORDS,{icon:L.divIcon({className:'',html:'<div style="width:28px;height:28px;background:#C62828;border:3px solid #fff;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center"><div style="width:8px;height:8px;background:#fff;border-radius:50%"></div></div>',iconSize:[28,28],iconAnchor:[14,14]}),zIndexOffset:1000}).addTo(map).bindPopup('<b>üè´ –°–∞–ª–∞—Ä—å–µ–≤–æ</b><br>–ú–æ—Å–∫–≤–∞, —É–ª. –°–∞–ª–∞—Ä—å–µ–≤—Å–∫–∞—è, –¥. 12, —Å—Ç—Ä. 1');

  const addrGroups={};
  ADDRESSES.forEach((item,i) => {
    const div=document.createElement('div');div.className='ai';div.id='a-'+i;
    const dTxt=item.dist>0?(item.dist.toFixed(1)+' –∫–º'):'‚Äî';
    const dCls=item.dist>0?distClass(item.dist):'dm';
    div.innerHTML='<div style="flex:1;min-width:0"><div class="an">'+item.name+'</div><div class="at" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+item.address+'</div></div><div class="ad '+dCls+'" id="d-'+i+'">'+dTxt+'</div>';
    container.appendChild(div);
    const ck=cleanAddress(item.address);
    if(!addrGroups[ck])addrGroups[ck]={addr:ck,count:0};
    addrGroups[ck].count++;
  });

  const topC=document.getElementById('topAddrs');
  Object.values(addrGroups).filter(g=>g.count>1).sort((a,b)=>b.count-a.count).slice(0,5).forEach(t=>{
    const d=document.createElement('div');d.className='ti';d.innerHTML='<span class="tc">'+t.count+'</span>'+t.addr;topC.appendChild(d);
  });

  let msk=0,mo=0;
  ADDRESSES.forEach(a=>{if(/(–º–æ—Å–∫–æ–≤—Å–∫–∞—è|–º—ã—Ç–∏—â–∏|–¥–æ–ª–≥–æ–ø—Ä—É–¥–Ω|–±–∞–ª–∞—à–∏—Ö–∞|—Ä–µ—É—Ç–æ–≤|–ø—É—à–∫–∏–Ω–æ|—â–µ–ª–∫–æ–≤|—Ö–∏–º–∫–∏|–∫—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫|–æ–¥–∏–Ω—Ü–æ–≤|–ª—é–±–µ—Ä—Ü|–æ–±–ª\.|–∑–∞—Ä–µ—á—å–µ|–ø–∞–≤—à–∏–Ω|–∑–µ–ª–µ–Ω–æ–≥—Ä–∞–¥|—Ç—Ä–æ–∏—Ü–∫|—Å–µ—Ä–≥–∏–µ–≤|–∞–ø—Ä–µ–ª–µ–≤–∫–∞)/i.test(a.address))mo++;else msk++;});
  if(msk+mo>0){
    const mP=Math.round(msk/(msk+mo)*100);
    document.getElementById('geoBar').style.display='block';
    document.getElementById('gm').style.width=Math.max(mP,5)+'%';document.getElementById('gm').textContent='–ú–æ—Å–∫–≤–∞ '+mP+'%';
    document.getElementById('go').style.width=Math.max(100-mP,5)+'%';document.getElementById('go').textContent='–ú–û '+(100-mP)+'%';
    document.getElementById('glm').textContent='–ú–æ—Å–∫–≤–∞: '+msk;document.getElementById('glo').textContent='–ú–û: '+mo;
  }

  const total=ADDRESSES.length;
  let found=0,failed=0,fromCache=0;
  const realDists=[],allCoords=[BASE_COORDS];

  for(let i=0;i<total;i++){
    const item=ADDRESSES[i];
    const cacheKey=cleanAddress(item.address);
    let result=cache[cacheKey]||null;
    if(result){fromCache++;}
    else{
      result=await geocode(item.address);
      if(result)cache[cacheKey]=result;
      await delay(300);
    }

    if(result&&result.coords){
      const coords=result.coords;
      const dist=haversine(BASE_COORDS,coords);
      const rd=Math.round(dist*10)/10;
      const ud=(item.dist>0)?item.dist:rd;
      realDists.push(ud);allCoords.push(coords);

      if(item.dist===0){
        const dEl=document.getElementById('d-'+i);
        dEl.textContent=rd.toFixed(1)+' –∫–º';dEl.className='ad '+distClass(rd);item.dist=rd;
      }

      const mk=L.marker(coords,{icon:createIcon(distColor(ud))}).addTo(map)
        .bindPopup('<b>'+item.name+'</b><br>'+item.address+'<br>üìè '+ud.toFixed(1)+' –∫–º');
      found++;

      const div=document.getElementById('a-'+i);
      (function(c,m,d){d.onclick=function(){map.setView(c,16,{animate:true});m.openPopup();document.querySelectorAll('.ai').forEach(el=>el.classList.remove('active'));d.classList.add('active');};})
      (coords,mk,div);
    }else{
      failed++;
      document.getElementById('a-'+i).innerHTML+='<span class="eb">‚ö† –Ω–µ –Ω–∞–π–¥–µ–Ω</span>';
      console.warn('NOT FOUND:',item.address,'‚Üí',cacheKey);
    }

    const p=i+1;
    ls.textContent=p+'/'+total+' ¬∑ ‚úÖ'+found+(fromCache?' ¬∑ üíæ'+fromCache:'')+(failed?' ¬∑ ‚ùå'+failed:'');
    pb.style.width=(p/total*100)+'%';
    if(p%15===0)saveCache(cache);
  }

  saveCache(cache);
  updateAnalytics(realDists);
  ls.textContent='‚úÖ '+found+'/'+total+(fromCache?' (üíæ'+fromCache+')':'')+(failed?' ¬∑ ‚ùå'+failed:'');
  setTimeout(()=>ld.style.display='none',1500);

  if(allCoords.length>1){
    map.fitBounds(L.latLngBounds(allCoords.map(c=>L.latLng(c[0],c[1]))),{padding:[30,30]});
  }
})();
</script>
</body></html>